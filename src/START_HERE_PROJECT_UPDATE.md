# üîÑ START HERE - Project ID Update Guide

**Date:** October 31, 2025  
**Update Type:** Supabase Project Migration  
**Old Project:** `ttsasgbrmswtjtenmksw`  
**New Project:** `uiawpsnhjpgkeepvagbs`

---

## üéØ WHAT HAPPENED

Your Estal PropTech platform has been updated to use a new Supabase project.

### ‚úÖ Already Completed:
- Core configuration files updated
- Application code configured for new project
- Documentation updated with new URLs
- All systems ready for new project

### ‚ö†Ô∏è What You Need To Do:
1. Get new anon key (2 minutes) **‚Üê DO THIS FIRST**
2. Optionally update documentation (5 minutes)
3. Deploy to new project (15 minutes)

---

## üîë STEP 1: Get New Anon Key (REQUIRED)

### Why?
The old anon key is encoded with the old project ID. You MUST get a new one.

### How:
1. **Visit:** https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/settings/api
2. **Find:** The "anon" or "public" key section
3. **Copy:** The key (starts with `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`)
4. **Paste:** Into `/utils/supabase/info.tsx`

### Update This File:
```typescript
// File: /utils/supabase/info.tsx

/* AUTOGENERATED FILE - DO NOT EDIT CONTENTS */

export const projectId = "uiawpsnhjpgkeepvagbs"
export const publicAnonKey = "YOUR_NEW_ANON_KEY_HERE"  // ‚Üê PASTE NEW KEY
```

### How to Get It:
![Anon Key Location](https://supabase.com/docs/guides/api#api-url-and-keys)

In Supabase Dashboard:
```
1. Click "Settings" (left sidebar)
2. Click "API"
3. Look for "Project API keys"
4. Copy the "anon" key (NOT the service_role key)
```

---

## üìÑ STEP 2: Update Documentation (OPTIONAL)

Documentation files contain 104 references to the old project ID. These files don't affect functionality, but updating them helps keep your documentation accurate.

### Quick Method (Recommended):

**Using VS Code:**
1. Open VS Code
2. Press `Ctrl+Shift+H` (Windows/Linux) or `Cmd+Shift+H` (Mac)
3. In "Search" field: `ttsasgbrmswtjtenmksw`
4. In "Replace" field: `uiawpsnhjpgkeepvagbs`
5. In "Files to include": `*.md`
6. Click "Replace All" button
7. Done! ‚úÖ

**Using Command Line (Unix/Mac):**
```bash
# Update all markdown files in root directory
find . -maxdepth 1 -name "*.md" -type f -exec sed -i '' 's/ttsasgbrmswtjtenmksw/uiawpsnhjpgkeepvagbs/g' {} +

# Update all markdown files in docs directory
find ./docs -name "*.md" -type f -exec sed -i '' 's/ttsasgbrmswtjtenmksw/uiawpsnhjpgkeepvagbs/g' {} +
```

**Using Command Line (Windows PowerShell):**
```powershell
Get-ChildItem -Path . -Filter *.md -Recurse | ForEach-Object {
    (Get-Content $_.FullName) -replace 'ttsasgbrmswtjtenmksw', 'uiawpsnhjpgkeepvagbs' | Set-Content $_.FullName
}
```

### Files to Update:
See `/UPDATE_ALL_DOCS.md` for the complete list of ~86 markdown files.

---

## üöÄ STEP 3: Deploy to New Project

Once you have the new anon key, follow these deployment steps:

### 3.1 Deploy Database (5 minutes)

1. **Open SQL Editor:**
   https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/sql/new

2. **Copy SQL File:**
   Open `/supabase/functions/server/database-setup-fixed.sql`

3. **Paste and Run:**
   - Paste the entire SQL content
   - Click "Run" button
   - Wait for success message

4. **Verify:**
   - Go to: https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/editor
   - You should see tables: `properties`, `maintenance_requests`, `financial_reports`, `kv_store_0ffb685e`

### 3.2 Deploy Edge Function (3 minutes)

```bash
# 1. Login to Supabase CLI
supabase login

# 2. Link to your new project
supabase link --project-ref uiawpsnhjpgkeepvagbs

# 3. Deploy the function
supabase functions deploy make-server

# 4. Test it works
curl https://uiawpsnhjpgkeepvagbs.supabase.co/functions/v1/make-server-0ffb685e/health
```

**Expected Response:**
```json
{
  "status": "healthy",
  "service": "Estal PropTech Server",
  "project": "uiawpsnhjpgkeepvagbs"
}
```

### 3.3 Create Admin User (2 minutes)

**Option A: Via Dashboard (Easiest)**
1. Go to: https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/auth/users
2. Click "Add user"
3. Fill in:
   - Email: `admin@estal.com`
   - Password: `SecurePass123!`
   - Click "Auto Confirm User" (important!)
4. Click "Create user"
5. Click on the user ‚Üí "Raw user meta data" ‚Üí Edit
6. Add: `{"role": "admin", "name": "Admin User"}`
7. Save

**Option B: Via API**
```bash
curl -X POST https://uiawpsnhjpgkeepvagbs.supabase.co/functions/v1/make-server-0ffb685e/signup \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@estal.com",
    "password": "SecurePass123!",
    "name": "Admin User",
    "role": "admin"
  }'
```

### 3.4 Test Application (2 minutes)

```bash
# Start development server
npm run dev

# Open browser to http://localhost:5173
# Try logging in with:
#   Email: admin@estal.com
#   Password: SecurePass123!
```

**Check browser console:**
```
‚úÖ Supabase client initialized: https://uiawpsnhjpgkeepvagbs.supabase.co
```

---

## ‚úÖ VERIFICATION CHECKLIST

After completing all steps, verify:

- [ ] New anon key is in `/utils/supabase/info.tsx`
- [ ] Project ID shows `uiawpsnhjpgkeepvagbs` in config files
- [ ] Database tables exist in Supabase dashboard
- [ ] Edge function responds to health check
- [ ] Admin user created and has `role: admin` metadata
- [ ] Can login to application with admin@estal.com
- [ ] Browser console shows new project URL
- [ ] No 401/403 errors in network tab

---

## üîó QUICK REFERENCE LINKS

### Your New Project Dashboard
```
Main Dashboard:
https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs

SQL Editor (for database):
https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/sql/new

Table Editor (to verify data):
https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/editor

Auth Users (to create users):
https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/auth/users

API Settings (to get anon key):
https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/settings/api

Edge Functions (to check deployment):
https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/functions
```

### Your New API Endpoints
```
REST API:
https://uiawpsnhjpgkeepvagbs.supabase.co/rest/v1/

Auth API:
https://uiawpsnhjpgkeepvagbs.supabase.co/auth/v1/

Storage API:
https://uiawpsnhjpgkeepvagbs.supabase.co/storage/v1/

Functions API:
https://uiawpsnhjpgkeepvagbs.supabase.co/functions/v1/

Your Edge Function:
https://uiawpsnhjpgkeepvagbs.supabase.co/functions/v1/make-server-0ffb685e/
```

### Your New Database Connection
```bash
# PostgreSQL connection string
postgresql://postgres:[YOUR-PASSWORD]@db.uiawpsnhjpgkeepvagbs.supabase.co:5432/postgres

# psql command
psql -h db.uiawpsnhjpgkeepvagbs.supabase.co -p 5432 -d postgres -U postgres
```

---

## üö® TROUBLESHOOTING

### Problem: "Can't connect to Supabase"
**Solution:**
1. Check you've updated the anon key in `/utils/supabase/info.tsx`
2. Verify it's the NEW anon key (not the old one)
3. Check browser console shows new URL
4. Check network tab for API requests

### Problem: "401 Unauthorized" errors
**Cause:** Using old anon key or not updated
**Solution:**
- Get new anon key: https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/settings/api
- Update `/utils/supabase/info.tsx`
- Restart dev server (`npm run dev`)

### Problem: "Table/relation does not exist"
**Cause:** Database not set up
**Solution:**
- Run SQL setup: https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/sql/new
- Use file: `/supabase/functions/server/database-setup-fixed.sql`

### Problem: "Can't login to application"
**Cause:** No users created yet
**Solution:**
- Create user: https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/auth/users
- Make sure to add `role` to user metadata
- Make sure email is confirmed

### Problem: "Function not found"
**Cause:** Edge function not deployed
**Solution:**
```bash
supabase login
supabase link --project-ref uiawpsnhjpgkeepvagbs
supabase functions deploy make-server
```

### Problem: "Project not found"
**Cause:** Wrong project ID
**Solution:**
- Verify project ID is `uiawpsnhjpgkeepvagbs`
- Check: https://supabase.com/dashboard
- Confirm you can see the project in your dashboard

---

## üìä FILES THAT WERE CHANGED

### Core Configuration (Already Updated ‚úÖ)
```
/utils/supabase/info.tsx              ‚Üê Project ID updated
/supabase/config.toml                 ‚Üê Project ID updated
/CURRENT_STATUS.md                    ‚Üê URLs updated
```

### Documentation (Optional Updates)
```
All *.md files contain references to old project ID
See /UPDATE_ALL_DOCS.md for complete list
Use search-and-replace to update quickly
```

### Code Files (No Changes Needed ‚úÖ)
```
Application code automatically uses projectId variable
No changes needed to .ts, .tsx, or .css files
Just need to update anon key!
```

---

## ‚è±Ô∏è TIME ESTIMATE

| Task | Time | Required? |
|------|------|-----------|
| Get new anon key | 2 min | ‚úÖ Yes |
| Update documentation | 5 min | ‚ö™ Optional |
| Deploy database | 5 min | ‚úÖ Yes |
| Deploy edge function | 3 min | ‚úÖ Yes |
| Create admin user | 2 min | ‚úÖ Yes |
| Test application | 2 min | ‚úÖ Yes |
| **Total** | **14-19 min** | - |

---

## üìû NEED HELP?

### Reference Documents:
- **This guide:** `/START_HERE_PROJECT_UPDATE.md`
- **Update status:** `/PROJECT_ID_UPDATED.md`
- **Update checklist:** `/PROJECT_ID_UPDATE_STATUS.md`
- **Documentation list:** `/UPDATE_ALL_DOCS.md`
- **Current status:** `/CURRENT_STATUS.md`

### Supabase Resources:
- **Dashboard:** https://supabase.com/dashboard
- **Documentation:** https://supabase.com/docs
- **API Reference:** https://supabase.com/docs/reference

### Common Commands:
```bash
# Check current config
grep "projectId" utils/supabase/info.tsx
grep "project_id" supabase/config.toml

# Test connection
npm run dev

# Deploy function
supabase functions deploy make-server

# Test function
curl https://uiawpsnhjpgkeepvagbs.supabase.co/functions/v1/make-server-0ffb685e/health
```

---

## ‚ú® SUMMARY

### What's Done:
- ‚úÖ Project ID updated in core files
- ‚úÖ Config files synchronized
- ‚úÖ Application ready for new project
- ‚úÖ Deployment guides updated

### What's Next:
1. **Get new anon key** (2 min) üëà **START HERE**
2. Deploy database (5 min)
3. Deploy edge function (3 min)
4. Create admin user (2 min)
5. Test & celebrate! üéâ

### Total Time: ~12-14 minutes

---

<div align="center">

## üéØ YOUR ACTION PLAN

### Step 1 (NOW):
**Get Anon Key** üëâ https://supabase.com/dashboard/project/uiawpsnhjpgkeepvagbs/settings/api

### Step 2 (AFTER):
**Follow deployment steps** above or see `/CURRENT_STATUS.md`

### Step 3 (OPTIONAL):
**Update documentation** using search-and-replace

---

**Questions?** Check `/PROJECT_ID_UPDATE_STATUS.md` for detailed information.

**Ready to deploy?** See `/CURRENT_STATUS.md` for deployment checklist.

---

**üöÄ You're almost there! Just need the anon key and you're good to go!**

</div>

---

**Document Created:** October 31, 2025  
**Project:** Estal PropTech Platform  
**Update Type:** Supabase Project Migration  
**Status:** ‚ö†Ô∏è Awaiting Anon Key  
**Next:** Get key from dashboard and deploy!

